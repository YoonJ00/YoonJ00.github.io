TCP/IP 서버-클라이언트 구조 [TCP/IP 윈도우 소켓 프로그래밍]
: <b>1. TCP 서버-클라이언트 개념</b><br>
대표적인 웹 클라이언트인 인터넷 익스프로러(Internet exploer)는 사용자가 입력한 주소를 참조해 접속 대기 중인 웹 서버에 접속한 후 HTTP를 이용해 요청 메시지(예를 들어, 웹 페이지 경로명)를 보낸다.<br>
웹 서버는 인터넷 익스플로러로부터 받은 메시지를 분석한 후 역시 HTTP를 이용해 응답 메시지(예를 들어, 웹 페이지 데이터)를 다시 보낸다.<br>
인터넷 익스플로러는 웹 서버로부터 받은 데이터를 처리해 화면에 표시한다.<br>
HTTP는 TCP에 기반한 프로토콜이므로 웹 서버-클라이언트는 대표적인 TCP 서버-클라이언트 응용 프로그램이라 할 수 있다.<br><br><br>
<b>TCP 서버-클라이언트의 핵심 동작을 개념적으로 정리하면 다음과 같다.(괄호 안은 사욜할 소켓 함수를 표시)</b><br>
(1) 서버는 먼저 실행하여 클라이언트가 접속하기를 기다린다. (listen) <br>
(2) 클라이언트는 서버에 접속(connect)하여 데이터를 보낸다. (send) <br>
(3) 서버는 클라이언트 접속을 수용하고(accept) 클라이언트가 보낸 데이터를 받아서(recv) 처리한다. <br>
(4) 서버는 처리한 데이터를 클라이언트에 보낸다. (send) <br>
(5) 클라이언트는 서버가 보낸 데이터를 받아서(recv) 처리한다. <br>
(6) 데이터를 주고받는 과정을 모두 마치면 접속을 끊는다. (closesocket) <br><br>
이와 같은 방식은 앞에서 예로 든 웹 서버 - 클라이언트는 물론, 텔넷 서버-클라이언트나 FTP 서버-클라이언트 등에도 동일하게 적용된다.<br><br><br>
<b>2. TCP 서버-클라이언트 동작 원리</b><br>
TCP 서버와 TCP 클라이언트가 연결되어 통신을 수행하는 단계별 동작 과정을 요약하면 다음과 같다.<br><br>
(1) 서버는 소켓을 생성한 후 클라이언트가 접속하기를 기다린다.<br>
이때, 서버가 사용하는 소켓으느 특정 포트 번호(예를 들어, 9000)와 결합되어 있어서 이 포트 번호로 접속하는 클라이언트만 수용할 수 있다.<br><br>
(2) 클라이언트가 서버에 접속한다.<br>
이때, TCP 프로토콜 수준에서 연결 설정을 위한 패킷 교환이 일어난다.<br>
TCP 연결 시에는 세 개의 패킷을 주고 받으며 각각 SYN,SYN/ACK, ACK라고 부른다.<br><br>
(3) TCP 프로토콜 수준의 연결 절차가 끝나면, 서버는 접속한 클라이언트와 통신할 수 있는 새로운 소켓을 생성한다.<br>
이 소켓을 이용해 서버는 클라이언트와 데이터를 주고 받는다.<br>
기존 소켓은 새로운 클라이언트 접속을 수용하는 용도로 계속 사용한다.<br><br>
(4) 두 클라이언트가 접속한 후의 상태일 경우, 서버에는 소켓이 총 세 개 존재하며, 이중 두 소켓을 접속한 클라이언트와 통신하는 용도로 사용된다.<br><br>
TCP 서버-클라이언트가 통신하는 상황을 일반적인 형태로 나타내면, 서버 측 소켓과 클라이언트 측 소켓이 일대일로 대응함을 알 수 있다.<br>클라이언트 한 개가 소켓을 두 개 이상 사용해 서버에 접속할 수도 있다.    